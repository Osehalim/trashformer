# Trashformer Robot - Default Configuration
# This file contains all default settings for the robot

# ============================================================================
# Robot Identity
# ============================================================================
robot:
  name: "Trashformer"
  version: "1.0.0"
  description: "Autonomous trash collection robot"

# ============================================================================
# Hardware Configuration
# ============================================================================
hardware:
  # Serial communication settings
  serial_port: "/dev/ttyUSB0"
  baud_rate: 115200
  timeout: 1.0
  
  # I2C settings for PCA9685
  i2c_bus: 1
  i2c_address: 0x40  # Default PCA9685 address

# ============================================================================
# Arm Configuration (3-Servo Arm via PCA9685)
# ============================================================================
arm:
  # PWM frequency
  pwm_frequency: 50  # 50Hz for servos
  
  # PCA9685 channel assignments
  servo_channels:
    shoulder: 0
    elbow: 1
    gripper: 2
  
  # Servo angle limits (degrees)
  # Shoulder: 0° down, 90° horizontal, 180° up
  # Elbow:    0° center/straight, rotates RIGHT to 90° (LIMITED)
  # Gripper:  0° open, 90° closed
  angle_limits:
    shoulder:
      min: 0
      max: 180
      home: 0
    elbow:
      min: 0
      max: 90        # ← LIMITED to prevent over-rotation
      home: 0
    gripper:
      min: 0
      max: 90
      home: 0
  
  # PWM pulse width limits (microseconds)
  pwm_limits:
    min_pulse: 500
    max_pulse: 2500
  
  # Movement settings
  movement:
    default_speed: 50
    max_speed: 100
    smooth_steps: 10
  
  # Physical dimensions (meters)
  dimensions:
    shoulder_length: 0.15
    forearm_length: 0.12
    gripper_length: 0.05
  
  # Safety limits
  safety:
    max_reach: 0.30
    min_ground_clearance: 0.05

# ============================================================================
# Drive System Configuration
# ============================================================================
drive:
  motor_controller:
    address: 128
    timeout: 100
  
  wheel_diameter: 0.15
  track_width: 0.30
  
  max_linear_speed: 1.0
  max_angular_speed: 2.0
  
  pid:
    kp: 1.0
    ki: 0.1
    kd: 0.05

# ============================================================================
# Camera Configuration
# ============================================================================
camera:
  device: 0
  width: 640
  height: 480
  fps: 30
  
  use_calibration: true
  calibration_file: "data/calibration/camera_params.json"

# ============================================================================
# Vision Processing
# ============================================================================
vision:
  detection:
    model_path: "models/trash_detector.pth"
    confidence_threshold: 0.7
    nms_threshold: 0.4
    input_size: [640, 640]
  
  segmentation:
    model_path: "models/segmentation_model.onnx"
    enabled: false
  
  tracking:
    max_age: 30
    min_hits: 3
    iou_threshold: 0.3

# ============================================================================
# Sensor Configuration
# ============================================================================
sensors:
  imu:
    enabled: true
    update_rate: 100
    calibration_file: "data/calibration/imu_offsets.json"
  
  ultrasonic:
    enabled: true
    update_rate: 10
    max_range: 4.0
    min_range: 0.02
  
  tof:
    enabled: false
    update_rate: 20
  
  limit_switches:
    enabled: true
    debounce_time: 0.05
  
  fusion:
    enabled: true
    filter_type: "kalman"

# ============================================================================
# Safety System
# ============================================================================
safety:
  emergency_stop:
    enabled: true
    pin: 17
    active_low: true
  
  collision:
    enabled: true
    stop_distance: 0.2
    warning_distance: 0.5
  
  tilt:
    max_angle: 30
    shutdown_angle: 45
  
  watchdog:
    enabled: true
    timeout: 5.0
    check_interval: 1.0

# ============================================================================
# Behavior System
# ============================================================================
behavior:
  default_state: "idle"
  
  autonomous:
    search_pattern: "spiral"
    pickup_distance: 0.3
    approach_speed: 0.3
  
  navigation:
    goal_tolerance: 0.1
    rotation_tolerance: 0.1
    planning_rate: 10

# ============================================================================
# Teleoperation
# ============================================================================
teleop:
  keyboard:
    enabled: true
    linear_speed_step: 0.1
    angular_speed_step: 0.2
  
  gamepad:
    enabled: true
    device_index: 0
    deadzone: 0.1
    max_linear_speed: 0.8
    max_angular_speed: 1.5
  
  arm_control:
    joint_step: 5
    speed_multiplier: 1.0

# ============================================================================
# Logging Configuration
# ============================================================================
logging:
  level: "INFO"
  console: true
  file: true
  log_directory: "logs"
  
  modules:
    arm: "DEBUG"
    vision: "INFO"
    drive: "INFO"
    sensors: "WARNING"

# ============================================================================
# Performance Tuning
# ============================================================================
performance:
  main_loop_rate: 50
  sensor_loop_rate: 100
  vision_loop_rate: 30
  
  use_multithreading: true
  thread_priorities:
    safety: 10
    sensors: 8
    control: 6
    vision: 4
    logging: 2

# ============================================================================
# Data Recording
# ============================================================================
recording:
  enabled: false
  directory: "data/recordings"
  
  record:
    sensor_data: true
    camera_feed: false
    commands: true
    state: true
  
  format: "csv"
  compression: true